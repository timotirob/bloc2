= R√©vision : D√©pendances Fonctionnelles et Formes Normales (FN)
:doctype: article
:encoding: utf-8
:lang: fr
:toc: left
:toc-title: Sommaire
:allow-uri-read:
:imagesdir: ./images

== üéØ Objectifs de la r√©vision
* Mieux appr√©hender le niveau de la mod√©lisation relationnelle
* Comprendre la notion de **D√©pendance Fonctionnelle** (DF).
* Ma√Ætriser les d√©finitions et les crit√®res de la **1√®re, 2√®me, 3√®me Forme Normale** (1NF, 2NF, 3NF).
* Ma√Ætriser la d√©finition et le crit√®re de la **Forme Normale de Boyce-Codd** (BCNF).
* Savoir appliquer la normalisation pour obtenir un Mod√®le Relationnel propre (jusqu'√† 3NF/BCNF).

== üí° Fondements et Terminologie
Un mod√®le de donn√©es relationnel doit √™tre normalis√© pour √©liminer la redondance et les anomalies de mise √† jour (insertion, modification, suppression).

.Niveaux de mod√©lisation (Conceptuel / Logique / Physique)
image::NiveauxMod√©lisations.png[Niveaux de mod√©lisation, width=600, align="center"]

=== D√©finition du mod√®le relationnel

Un mod√®le logique de donn√©es sp√©cifiant un sch√©ma pour une base de donn√©es relationnelle soit : les tables, les champs de chaque table et leurs propri√©t√©s, la cl√© primaire des tables, les cl√©s √©trang√®res assurant les liaisons entre les tables et les contraintes d‚Äôint√©grit√© portant sur ces liaisons

Pertinence du mod√®le relationnel:

* Ind√©pendant du SGBD, tout en √©tant plus proche des tables
* Etape de v√©rification / validation mod√®le
* Typage et estimation volum√©trie de la base
* Pr√©cisions sur les contraintes, notamment UNIQUE et CHECK

=== Vocabulaire

Le sch√©ma suivant illustre les diff√©rents termes utilis√©s pour des m√™mes notions selon le contexte:

.Des termes diff√©rents pour la m√™me notion selon le contexte
image::Vocabulaire.png[Contextes, width=600, align="center"]

=== D√©pendance Fonctionnelle (DF)
Une d√©pendance fonctionnelle, not√©e DETERMINANT -> DEPENDANT, signifie que pour toute valeur de l'attribut ou du groupe d'attributs DETERMINANT (le *d√©terminant*), il existe une seule valeur correspondante pour l'attribut ou le groupe d'attributs DEPENDANT (le *d√©termin√©*).

* *Exemple :* `Num√©ro Employ√©` -> `Nom Employ√©`

==== Dep√©ndance fonctionnelle √©l√©mentaire

Une DF (Attribut1, Attribut2) -> DEPENDANT est √©l√©mentaire si
Attribut1 -> DEPENDANT n‚Äôest pas DF ET
Attribut2 -> DEPENDANT n‚Äôest pas DF

Permet de d√©tecter les probl√®mes de 2√®me Forme Normale

Exemple (C. SOUTOU): ( num_pilote,jour ) -> nb_heures_vol est √©l√©mentaire

==== Dep√©ndance fonctionnelle directe

Une DF DETERMINANT -> DEPENDANT est directe si elle ne peut pas √™tre d√©duite par transitivit√© c‚Äôest √† dire:

- DETERMINANT -> attributX n‚Äôest pas DF OU BIEN
- AttributX -> DEPENDANT n‚Äôest pas DF

Permet de d√©tecter les probl√®mes de 3√®me Forme Normale

Exemple (C. SOUTOU): immatriculation a√©ronef -> nom du constructeur n‚Äôest PAS directe car
immatriculation a√©ronef -> type avion est DIRECTE ET
Type avion -> nom constructeur est aussi DIRECTE


=== Niveau Logique
Le niveau logique se rapproche des tables tout en restant ind√©pendant du Syst√®me de Gestion de Base de Donn√©es (SGBD). C'est √† ce niveau que les Formes Normales sont appliqu√©es.

=== Principes de mod√©lisation
Un mod√®le de donn√©es relationnel doit √™tre normalis√©
La notion de normalisation comporte plusieurs niveaux, appel√©s formes, que nous allons pr√©senter successivement

Chaque forme normale permet de r√©soudre des probl√®mes de mod√©lisation que posent un non respect de ces principes

== ü•á 1√®re Forme Normale (1NF)


Une relation est en **1NF** si et seulement si:

1. Elle poss√®de au moins une clef
2. Tous ses attributs sont *atomiques* (indivisibles)
3. Aucun attribut n'est r√©p√©t√©


=== Probl√®me typique

La relation ci-dessous est-elle en 1√®re forme normale ? Si non, que faut-il faire ?

.Probl√®me de 1√®re Forme Normale
image::PB1NF.png[Contextes, width=600, align="center"]


---
== ü•à 2√®me Forme Normale (2NF)


Une relation en **1NF** est en **2NF** si et seulement si *tout attribut non-cl√© est en d√©pendance fonctionnelle compl√®te vis-√†-vis de la cl√© primaire*.

* *R√®gle :* Il ne doit y avoir aucune **d√©pendance fonctionnelle partielle** de la cl√© primaire vers un attribut non-cl√©. (Concerne uniquement les relations avec une cl√© primaire compos√©e).

=== Probl√®me typique (D√©pendance partielle)


---
== ü•â 3√®me Forme Normale (3NF)


Une relation en **2NF** est en **3NF** si et seulement si *aucun attribut non-cl√© n'est en d√©pendance fonctionnelle transitive vis-√†-vis de la cl√© primaire*.

* *R√®gle :* Il ne doit y avoir aucune d√©pendance d'un attribut non-cl√© vers un autre attribut non-cl√©. Si $A \to B$ et $B \to C$ et que $A$ est la cl√©, alors il y a une **d√©pendance transitive** $A \to C$ via $B$.

=== Probl√®me typique
Soit la relation : `VOITURE (NV, MARQUE, TYPE, PUISSANCE, COULEUR)`.
*Probl√®me :* L'attribut non-cl√© `TYPE` d√©termine `MARQUE` et `PUISSANCE`.
*Solution :* D√©composition en `VOITURE (NV, TYPE, COULEUR)` et `MODELE (TYPE, MARQUE, PUISSANCE)`.

---
== üëë Forme Normale de Boyce-Codd (BCNF)


Une relation est en **BCNF** si et seulement si elle est en **3NF** *ET* si toute d√©pendance fonctionnelle non triviale $A \to B$ v√©rifie que $A$ est une **cl√© candidate** pour la relation.

* *R√®gle simplifi√©e :* Le seul d√©terminant (partie gauche de la DF) est une cl√© candidate.

---
== üìù Exercices de Mod√©lisation (Solutions)

=== Exercice 1 : Ligne de Commande
*Relation :* `LigneCommande (Num√©ro de commande, Num√©ro de produit, Description, Prix, Quantit√©)`

1.  **DF :**
* `(Num√©ro de commande, Num√©ro de produit)` $\to$ `Quantit√©`
* `Num√©ro de produit` $\to$ `Description, Prix`
2.  **Cl√© :** `(Num√©ro de commande, Num√©ro de produit)`
3.  **Forme Normale :** **1NF**, mais pas en **2NF** (d√©pendance partielle sur `Num√©ro de produit`).
4.  **Critique :** Redondance et anomalies de mise √† jour pour les informations Produit.

=== Exercice 2 : Employ√©

| Relation | Cl√© | Autres DF | FN Max. | Raison |
| :--- | :--- | :--- | :--- | :--- |
| **R1** (Cl√© simple) | `num√©ro employ√©` | Aucune | **3NF** | Cl√© simple, pas de transitive. |
| **R2** (Attribut multivalu√©) | N/A | N/A | **Non normalis√©** | N'est pas en 1NF. |
| **R3** (DF transitive) | `num√©ro employ√©` | `Code emploi` $\to$ `libell√© emploi` | **2NF** | D√©pendance transitive : `NE` $\to$ `CodeE` $\to$ `Libell√©E` (Non 3NF). |
| **R4** (DF partielle) | `(num√©ro employ√©, projet)` | `Num√©ro employ√©` $\to$ `nom employ√©` | **1NF** | D√©pendance partielle : `NE` $\to$ `NomE` (Non 2NF). |

=== Exercice 3 : Bon de Commande


*Objectif :* Mod√®le relationnel en **3√®me forme normale**.

| Relation | Cl√© Primaire (PK) | Attributs |
| :--- | :--- | :--- |
| **CLIENT** | **`Num√©ro Client`** | `Num√©ro Client`, `Nom Client`, `Adresse Client` |
| **COMMANDE** | **`Num√©ro Commande`** | `Num√©ro Commande`, `Date Commande`, `Num√©ro Client` (FK) |
| **PRODUIT** | **`Num√©ro Produit`** | `Num√©ro Produit`, `Description Produit`, `Prix Unitaire` |
| **LIGNE_COMMANDE** | **`Num√©ro Commande`, `Num√©ro Produit`** | `Num√©ro Commande` (FK), `Num√©ro Produit` (FK), `Quantit√©` |

=== Exercice 4 : Groupe Musical

*Hypoth√®ses :* Cl√© : `(Salle, Ann√©e, Groupe)`.

1.  **Extrait 1 :** `(Salle, Ann√©e, Groupe, Genre)`

* **DF :** `Groupe` $\to$ `Genre`.
* **Forme Normale :** **1NF**. **N'est pas en 2NF** (d√©pendance partielle).

2.  **Extrait 2 :** `(Salle, Ann√©e, Groupe, Spectateurs)`

* **DF :** `(Salle, Ann√©e, Groupe)` $\to$ `Spectateurs`.
* **Forme Normale :** **3NF**. (Satisfait 2NF et 3NF).

=== Exercice 5 : Transport Maritime
*Cl√©(s) :* $K = \{\text{Bateau, Date arriv√©e}\}$

* **Mod√©lisation BCNF propos√©e :**
* **BATEAU** (`Bateau`, `Type bateau`)
* **VOYAGE** (`Identifiant voyage`, `Cargaison`)
* **TRANSPORT** (`Bateau*`, `Date arriv√©e`, `Identifiant voyage*`, `Port de destination`)